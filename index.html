<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ch√∫c M·ª´ng NƒÉm M·ªõi 2026 - T·∫øt B√≠nh Ng·ªç</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@11/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 30px rgba(250, 204, 21, 0.8), 0 0 60px rgba(250, 204, 21, 0.5); }
            50% { text-shadow: 0 0 40px rgba(250, 204, 21, 1), 0 0 80px rgba(250, 204, 21, 0.7); }
        }
        .glow-text {
            animation: glow 2s ease-in-out infinite;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { motion, AnimatePresence } = Motion;
        const { createLucideIcon } = lucide;

        // Icons
        const Sparkles = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275Z"/>
                <path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/>
            </svg>
        );

        const Settings = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
                <circle cx="12" cy="12" r="3"/>
            </svg>
        );

        const X = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M18 6 6 18"/><path d="m6 6 12 12"/>
            </svg>
        );

        // Falling Petals Component
        function FallingPetals() {
            const [petals, setPetals] = useState([]);

            useEffect(() => {
                const emojis = ['üå∏', 'üå∫', '‚ùÑÔ∏è', '‚ú®', 'üéä'];
                const newPetals = Array.from({ length: 30 }, (_, i) => ({
                    id: i,
                    x: Math.random() * 100,
                    delay: Math.random() * 5,
                    duration: 5 + Math.random() * 5,
                    size: 20 + Math.random() * 20,
                    emoji: emojis[Math.floor(Math.random() * emojis.length)],
                }));
                setPetals(newPetals);
            }, []);

            return (
                <div className="fixed inset-0 pointer-events-none overflow-hidden z-0">
                    {petals.map((petal) => (
                        <motion.div
                            key={petal.id}
                            className="absolute"
                            initial={{ top: '-10%', left: `${petal.x}%`, opacity: 0 }}
                            animate={{
                                top: '110%',
                                opacity: [0, 1, 1, 0],
                                rotate: [0, 360],
                                x: [0, 30, -30, 0],
                            }}
                            transition={{
                                duration: petal.duration,
                                delay: petal.delay,
                                repeat: Infinity,
                                ease: 'linear',
                            }}
                            style={{
                                fontSize: `${petal.size}px`,
                            }}
                        >
                            {petal.emoji}
                        </motion.div>
                    ))}
                </div>
            );
        }

        // Header Component
        function Header({ onDropRatesChange, dropRates }) {
            const [isSettingsOpen, setIsSettingsOpen] = useState(false);
            const [tempDropRates, setTempDropRates] = useState(dropRates);

            const handleDropRateChange = (key, value) => {
                setTempDropRates({
                    ...tempDropRates,
                    [key]: value,
                });
            };

            const handleSaveSettings = () => {
                onDropRatesChange(tempDropRates);
                setIsSettingsOpen(false);
            };

            const handleResetSettings = () => {
                const defaultRates = {
                    '1k': 1,
                    '2k': 5,
                    '5k': 10,
                    '10k': 15,
                    '20k': 25,
                    '50k': 25,
                    '100k': 10,
                    '200k': 3,
                    '500k': 0.5,
                };
                setTempDropRates(defaultRates);
                onDropRatesChange(defaultRates);
            };

            return (
                <>
                    <motion.header
                        initial={{ y: -100 }}
                        animate={{ y: 0 }}
                        className="fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-red-900/95 to-red-800/95 backdrop-blur-md border-b-4 border-yellow-400 shadow-lg"
                    >
                        <div className="max-w-7xl mx-auto px-4 py-4">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center gap-3">
                                    <div className="w-8 h-8 text-yellow-400"><Sparkles /></div>
                                    <span className="text-yellow-400 text-2xl">T·∫øt 2026</span>
                                </div>
                                <button
                                    onClick={() => setIsSettingsOpen(true)}
                                    className="text-yellow-100 hover:text-yellow-300 transition-colors flex items-center gap-2"
                                >
                                    <div className="w-6 h-6"><Settings /></div>
                                    <span className="hidden md:inline">C√†i ƒê·∫∑t</span>
                                </button>
                            </div>
                        </div>
                    </motion.header>

                    <AnimatePresence>
                        {isSettingsOpen && (
                            <>
                                <motion.div
                                    initial={{ opacity: 0 }}
                                    animate={{ opacity: 1 }}
                                    exit={{ opacity: 0 }}
                                    className="fixed inset-0 bg-black/50 z-50"
                                    onClick={() => setIsSettingsOpen(false)}
                                />
                                <motion.div
                                    initial={{ opacity: 0, scale: 0.9 }}
                                    animate={{ opacity: 1, scale: 1 }}
                                    exit={{ opacity: 0, scale: 0.9 }}
                                    className="fixed inset-4 md:inset-auto md:top-1/2 md:left-1/2 md:-translate-x-1/2 md:-translate-y-1/2 md:w-full md:max-w-2xl bg-gradient-to-br from-red-900 to-red-800 rounded-2xl shadow-2xl z-50 overflow-hidden"
                                >
                                    <div className="p-6 border-b-2 border-yellow-400/30 flex items-center justify-between">
                                        <h2 className="text-2xl font-bold text-yellow-400">C√†i ƒê·∫∑t T·ª∑ L·ªá L√¨ X√¨</h2>
                                        <button
                                            onClick={() => setIsSettingsOpen(false)}
                                            className="text-yellow-100 hover:text-yellow-300 transition-colors"
                                        >
                                            <div className="w-6 h-6"><X /></div>
                                        </button>
                                    </div>
                                    <div className="p-6 max-h-96 overflow-y-auto">
                                        <div className="space-y-4">
                                            {Object.entries(tempDropRates).map(([key, value]) => (
                                                <div key={key} className="flex items-center justify-between bg-red-950/50 p-4 rounded-lg">
                                                    <label className="text-yellow-100 font-medium">
                                                        L√¨ x√¨ {key.toUpperCase()}:
                                                    </label>
                                                    <div className="flex items-center gap-3">
                                                        <input
                                                            type="range"
                                                            min="0"
                                                            max="100"
                                                            step="0.5"
                                                            value={value}
                                                            onChange={(e) => handleDropRateChange(key, parseFloat(e.target.value))}
                                                            className="w-32 accent-yellow-400"
                                                        />
                                                        <span className="text-yellow-300 font-bold w-16 text-right">
                                                            {value}%
                                                        </span>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                    <div className="p-6 border-t-2 border-yellow-400/30 flex gap-3">
                                        <button
                                            onClick={handleResetSettings}
                                            className="flex-1 px-6 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium transition-colors"
                                        >
                                            ƒê·∫∑t L·∫°i M·∫∑c ƒê·ªãnh
                                        </button>
                                        <button
                                            onClick={handleSaveSettings}
                                            className="flex-1 px-6 py-3 bg-yellow-500 hover:bg-yellow-600 text-red-900 rounded-lg font-bold transition-colors"
                                        >
                                            L∆∞u C√†i ƒê·∫∑t
                                        </button>
                                    </div>
                                </motion.div>
                            </>
                        )}
                    </AnimatePresence>
                </>
            );
        }

        // Red Envelope Game Component
        function RedEnvelopeGame({ dropRates }) {
            const [isPlaying, setIsPlaying] = useState(false);
            const [result, setResult] = useState(null);
            const [totalAmount, setTotalAmount] = useState(0);
            const [history, setHistory] = useState([]);

            // S·∫Øp x·∫øp m·ªánh gi√° ƒë·ªÉ hi·ªÉn th·ªã cho ƒë·∫πp
            const sortedDenoms = Object.keys(dropRates).sort((a, b) => {
                const valA = parseInt(a.replace('k', ''));
                const valB = parseInt(b.replace('k', ''));
                return valA - valB;
            });

            const getRandomAmount = () => {
                const total = Object.values(dropRates).reduce((sum, rate) => sum + rate, 0);
                let random = Math.random() * total;
                
                for (const [amount, rate] of Object.entries(dropRates)) {
                    random -= rate;
                    if (random <= 0) {
                        return amount;
                    }
                }
                return '1k';
            };

            const handlePlay = () => {
                setIsPlaying(true);
                setResult(null);

                setTimeout(() => {
                    const amount = getRandomAmount();
                    const numericValue = parseInt(amount.replace('k', ''));
                    setResult(amount);
                    setTotalAmount(prev => prev + numericValue);
                    setHistory(prev => [{ amount, time: new Date().toLocaleTimeString('vi-VN') }, ...prev.slice(0, 4)]);
                    setIsPlaying(false);
                }, 1500); // Th·ªùi gian ch·ªù 1.5 gi√¢y
            };

            return (
                <div className="max-w-4xl mx-auto px-4 pb-16">
                    <motion.div
                        initial={{ opacity: 0, y: 20 }}
                        animate={{ opacity: 1, y: 0 }}
                        className="bg-gradient-to-br from-red-800 to-red-900 rounded-3xl shadow-2xl p-6 md:p-8 border-4 border-yellow-400"
                    >
                        <h2 className="text-3xl md:text-4xl font-bold text-yellow-400 text-center mb-6">
                            üßß L√¨ X√¨ May M·∫Øn üßß
                        </h2>

                        {/* GRID HI·ªÇN TH·ªä C√ÅC BAO L√å X√å */}
                        <div className="grid grid-cols-3 md:grid-cols-5 gap-3 w-full mb-8">
                            {sortedDenoms.map((denom) => {
                                const isWinner = result === denom;
                                return (
                                    <motion.div
                                        key={denom}
                                        animate={{
                                            scale: isWinner ? 1.15 : 1,
                                            backgroundColor: isWinner ? '#fbbf24' : 'rgba(69, 10, 10, 0.4)',
                                            borderColor: isWinner ? '#fff' : 'rgba(250, 204, 21, 0.3)',
                                            boxShadow: isWinner ? '0 0 20px rgba(250, 204, 21, 0.8)' : 'none'
                                        }}
                                        className={`
                                            aspect-[3/4] rounded-xl border-2 flex flex-col items-center justify-center relative overflow-hidden transition-colors duration-300
                                            ${isWinner ? 'z-10' : ''}
                                        `}
                                    >
                                        <div className="text-2xl mb-1">üßß</div>
                                        <span className={`font-bold text-sm md:text-base ${isWinner ? 'text-red-900' : 'text-yellow-400'}`}>
                                            {denom.toUpperCase()}
                                        </span>
                                    </motion.div>
                                );
                            })}
                        </div>

                        <div className="flex flex-col items-center gap-6">
                            {/* N√∫t b·∫•m l·ªõn */}
                            <motion.button
                                whileHover={{ scale: 1.05 }}
                                whileTap={{ scale: 0.95 }}
                                onClick={handlePlay}
                                disabled={isPlaying}
                                className={`text-8xl cursor-pointer transition-transform drop-shadow-[0_0_15px_rgba(250,204,21,0.5)] ${
                                    isPlaying ? 'animate-spin' : ''
                                }`}
                                style={{animationDuration: '2s'}}
                            >
                                <div className="bg-yellow-400 rounded-full p-4 border-4 border-red-600">
                                    üé≤
                                </div>
                            </motion.button>

                            <button
                                onClick={handlePlay}
                                disabled={isPlaying}
                                className="px-10 py-4 bg-gradient-to-r from-yellow-400 to-yellow-600 hover:from-yellow-300 hover:to-yellow-500 disabled:from-gray-500 disabled:to-gray-600 text-red-900 rounded-full text-2xl font-bold shadow-xl border-2 border-white/50 transition-all transform hover:-translate-y-1"
                            >
                                {isPlaying ? 'ƒêang quay...' : 'QUAY S·ªê NGAY'}
                            </button>

                            <AnimatePresence>
                                {result && (
                                    <motion.div
                                        initial={{ opacity: 0, scale: 0.5 }}
                                        animate={{ opacity: 1, scale: 1 }}
                                        exit={{ opacity: 0, scale: 0.5 }}
                                        className="text-center mt-4"
                                    >
                                        <p className="text-yellow-300 text-2xl mb-2">Ch√∫c m·ª´ng b·∫°n nh·∫≠n ƒë∆∞·ª£c:</p>
                                        <p className="text-6xl md:text-7xl font-bold text-yellow-400 glow-text">
                                            {result.toUpperCase()}
                                        </p>
                                    </motion.div>
                                )}
                            </AnimatePresence>

                            <div className="w-full bg-red-950/60 rounded-xl p-6 mt-4 border border-yellow-400/20">
                                <p className="text-yellow-300 text-xl text-center mb-2">
                                    T·ªïng ti·ªÅn t√≠ch l≈©y:
                                </p>
                                <p className="text-yellow-400 text-4xl font-bold text-center">
                                    {totalAmount.toLocaleString('vi-VN')}k VNƒê
                                </p>
                            </div>

                            {history.length > 0 && (
                                <div className="w-full bg-red-950/60 rounded-xl p-6 mt-4 border border-yellow-400/20">
                                    <h3 className="text-yellow-300 text-xl font-bold mb-4 text-center">
                                        L·ªãch S·ª≠ Tr√∫ng Th∆∞·ªüng
                                    </h3>
                                    <div className="space-y-2">
                                        {history.map((item, index) => (
                                            <div
                                                key={index}
                                                className="flex justify-between items-center bg-red-900/50 p-3 rounded-lg border border-white/10"
                                            >
                                                <span className="text-yellow-100/80 text-sm">{item.time}</span>
                                                <span className="text-yellow-400 font-bold">
                                                    {item.amount.toUpperCase()}
                                                </span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            )}
                        </div>
                    </motion.div>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [dropRates, setDropRates] = useState({
                '1k': 1,
                '2k': 5,
                '5k': 10,
                '10k': 15,
                '20k': 25,
                '50k': 25,
                '100k': 10,
                '200k': 3,
                '500k': 0.5,
            });

            return (
                <div className="min-h-screen bg-[url('https://images.unsplash.com/photo-1674154446487-73d2a0d8c07e?q=80&w=2000&auto=format&fit=crop')] bg-cover bg-center bg-fixed relative overflow-y-auto">
                     {/* Overlay t·ªëi ƒë·ªÉ ch·ªØ d·ªÖ ƒë·ªçc h∆°n tr√™n n·ªÅn ·∫£nh */}
                    <div className="fixed inset-0 bg-red-950/90 z-0"></div>

                    <div className="fixed inset-0 opacity-10 pointer-events-none z-0">
                        <div className="absolute top-10 left-10 text-8xl">üå∏</div>
                        <div className="absolute top-20 right-20 text-8xl">üå∫</div>
                        <div className="absolute bottom-40 left-1/3 text-8xl">üå∏</div>
                    </div>

                    <FallingPetals />
                    <Header onDropRatesChange={setDropRates} dropRates={dropRates} />

                    <main className="pt-24 pb-12 relative z-10">
                        <div className="text-center mb-8 px-4">
                            <h1 className="text-5xl md:text-7xl text-yellow-400 font-bold mb-4 glow-text uppercase tracking-wider">
                                V√≤ng Quay L√¨ X√¨
                            </h1>
                            <p className="text-2xl md:text-3xl text-yellow-200 font-light italic">
                                Ch√∫c M·ª´ng NƒÉm M·ªõi 2026
                            </p>
                        </div>

                        <RedEnvelopeGame dropRates={dropRates} />
                    </main>
                </div>
            );
        }

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
